<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotizador de Persianas</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
    <h1>Cotizador de Persianas</h1>
    <ul id="pestanas">
        <li><button id="tab-cotizar" onclick="mostrarPestana('cotizar')">Cotizar</button></li>
        <li> <button id="tab-enviar" onclick="mostrarPestana('enviar')">Enviar Cotizacion</button></li>
    </ul>

    <div id="contenidoPestanas">
        <div id="cotizar" class="pestana activa">
    <form action="/" method="post">
        <label>Alto (metros)</label>
        <input type="number" id="alto" name="Alto" step="0.01" value="{{ request.form.get('Alto', '') }}" required>
        <label>Ancho (metros)</label>
        <input type="number" id="ancho" name="Ancho" step="0.01" value="{{ request.form.get('Ancho', '') }}" required>
        <button>Calcular</button>
    </form>
    {% if resultado_cotizacion %}
    <div id="resultado">
        <h3>Precio: ${{ resultado_cotizacion|int}}</h3>
        <p>Ancho: {{ request.form.get('Ancho') }}m | Alto: {{ request.form.get('Alto') }}m</p>
        <button onclick="irPestanaEnvio()">Enviar Cotización</button>
    </div>
    {% endif %}
        </div>

        <div id="enviar" class="pestana">
            <form action="/enviar" method="post">
                <label>Nombre</label>
                <input type="text" id="nombre" name="nombre" required>
                
                <label>Teléfono</label>
                <input type="tel" id="telefono" name="telefono" required>
                
                <label>Email</label>
                <input type="email" id="email" name="E-mail" required>
                
                <label>Ancho (metros)</label>
                <input type="text" id="ancho-envio" readonly>
                <input type="hidden" id="ancho-envio-hidden" name="ancho_envio">
                
                <label>Alto (metros)</label>
                <input type="text" id="alto-envio" readonly>
                <input type="hidden" id="alto-envio-hidden" name="alto_envio">
                
                <label>Precio Final</label>
                <input type="text" id="precio-envio" readonly>
                <input type="hidden" id="precio-envio-hidden" name="precio_envio">
                
                <button type="submit">Enviar Cotización</button>
            </form>
        </div>
    </div>

    <script>
        function mostrarPestana(id) {
            const pestanas = document.querySelectorAll('.pestana');
            pestanas.forEach(p => p.classList.remove('activa'));
            document.getElementById(id).classList.add('activa');
        }

        function irPestanaEnvio() {
            const ancho = document.getElementById('ancho').value;
            const alto = document.getElementById('alto').value;
            const precio = document.querySelector('#resultado h3').textContent.replace('Precio: $', '').trim();
            
            document.getElementById('ancho-envio').value = ancho;
            document.getElementById('alto-envio').value = alto;
            document.getElementById('precio-envio').value = precio;
            
            document.getElementById('ancho-envio-hidden').value = ancho;
            document.getElementById('alto-envio-hidden').value = alto;
            document.getElementById('precio-envio-hidden').value = precio;
            
            mostrarPestana('enviar');
        }

        {% if resultado_cotizacion %}
        document.addEventListener('DOMContentLoaded', function() {
            const ancho = "{{ request.form.get('Ancho') }}";
            const alto = "{{ request.form.get('Alto') }}";
            const precio = "{{ resultado_cotizacion|int }}";
            
            document.getElementById('ancho-envio').value = ancho;
            document.getElementById('alto-envio').value = alto;
            document.getElementById('precio-envio').value = precio;
            
            document.getElementById('ancho-envio-hidden').value = ancho;
            document.getElementById('alto-envio-hidden').value = alto;
            document.getElementById('precio-envio-hidden').value = precio;
        });
        {% endif %}
    </script>
</body>
</html>